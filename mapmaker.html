<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <title>Atlas Horizon- Map Maker</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/mapmaker.css">
    <link rel="icon" href="./Resources/Additional/Icons/AtlasLogo.ico" type="image/x-icon">
    <base href="https://she-fairy.github.io/atlas-horizon/">
</head>
<body>
    <script>
        if (localStorage.getItem('user') === null) {
            window.location.href = "https://discord.com/oauth2/authorize?client_id=1293658198393487420&response_type=code&redirect_uri=https%3A%2F%2Fshe-fairy.github.io%2Fatlas-horizon%2Fauth%2Fdiscord%2Fcallback.html&scope=identify";
        } 
    </script>
    <nav>
        <div class="logo">
            <img src="./Resources/Additional/Icons/AtlasLogo.png" alt="Atlas Horizon Logo" class="logo-img">
            Atlas Horizon
        </div>
        <div class="nav-links">
            <a href="./index.html">Home</a>
            <a href="./mapmaker.html" class="active">Map Maker</a>
            <a href="./map-gallery.html">Map Gallery</a>
            <a href="./my-maps.html">My Maps</a>
            <input class="avatar" type="image" id="avatar" alt="Avatar">
        </div>
    </nav>

    <div class="mapmaker-container">
        <div class="toolbar">
            <div class="tool-section">
                <h3>Map Settings</h3>
                <div class="select-container">
                    <input type="text" value="Untitled Map" id="mapName" placeholder="Map Name">
                </div>
                <div class="select-container">
                    <label for="mapSize">Map Size:</label>
                    <select id="mapSize">
                        <option value="regular">Regular</option>
                        <option value="showdown">Showdown</option>
                        <option style="color:blueviolet" value="arena">Brawl Arena</option>
                        <option value="siege">Siege</option>
                        <option value="volley">Volley Brawl</option>
                        <option value="basket">Basket Brawl</option>
                    </select>
                </div>
                <div class="select-container">
                    <label for="gamemode">Gamemode:</label>
                    <select id="gamemode">
                        <option value="Gem_Grab">Gem Grab</option>
                        <option value="Showdown">Showdown</option>
                        <option value="Heist">Heist</option>
                        <option value="Bounty">Bounty</option>
                        <option value="Brawl_Ball">Brawl Ball</option>
                        <option value="Siege">Siege</option>
                        <option value="Snowtel_Thieves">Snowtel Thieves</option>
                        <option value="Hot_Zone">Hot Zone</option>
                        <option value="Knockout">Knockout</option>
                        <option value="Duels">Duels</option>
                        <option value="Wipeout">Wipeout</option>
                        <option value="Basket_Brawl">Basket Brawl</option>
                        <option value="Volley_Brawl">Volley Brawl</option>
                        <option value="Hold_The_Trophy">Hold The Trophy</option>
                        <option value="Hockey">Brawl Hockey</option> 
                        <option value="Token_Run">Token Run</option>
                        <option style="color:blueviolet" value="Brawl_Arena">Brawl Arena</option>
                        <option value="Dodgebrawl">Dodgebrawl</option> 
                    </select>
                </div>
                <div class="select-container">
                    <label for="environment">Environment:</label>
                    <select id="environment">
                        <option value="Desert">Desert</option>
                        <option value="Wasteland">Wasteland</option>
                        <option value="Mine">Mine</option>
                        <option value="Oasis">Oasis</option>
                        <option value="Grassy_Field">Grassy Field</option>
                        <option value="City">City</option>
                        <option value="Retropolis">Retropolis</option>
                        <option value="Mortuary">Mortuary</option>
                        <!-- <option value="Pirate_Ship">Pirate Ship</option> -->
                        <option value="Arcade">Arcade</option>
                        <option value="Stadium">Stadium</option>
                        <option value="Bazaar">Bazaar</option>
                        <!-- <option value="Super_City">Super City</option>
                        <option value="Gift_Shop">Gift Shop</option> -->
                        <option value="Bandstand">Bandstand</option> 
                        <option value="Holiday">Holiday</option>
                        <option value="Snowtel">Snowtel</option>
                        <option value="Scrapyard">Scrapyard</option>
                        <!-- <option value="Starr_Force">Starr Force</option> -->
                        <option value="Wild_West">Wild West</option>
                        <!-- <option value="Water_Park">Water Park</option> -->
                        <option value="Castle_Courtyard">Castle Courtyard</option>
                        <option value="Brawlywood">Brawlywood</option> 
                        <option value="Fighting_Game">Fighting Game</option>
                        <!-- <option value="Biodome">Biodome</option> -->
                        <option value="Stunt_Show">Stunt Show</option>
                        <option value="Deep_Sea">Deep Sea</option>
                        <!-- <option value="Robot_Factory">Robot Factory</option> -->
                        <option value="Ghost_Station">Ghost Station</option>
                        <!-- <option value="Candyland">Candyland</option> -->
                        <option value="The_Hub">The Hub</option>
                        <option value="Rooftop">Rooftop</option>
                        <option value="Rumble_Jungle">Rumble Jungle</option> 
                        <option value="Enchanted_Woods">Enchanted Woods</option>
                        <option value="Ranger_Ranch">Ranger Ranch</option>
                        <!-- <option value="Circus">Bizarre Circus</option> 
                        <option value="Coin_Factory">Coin Factory</option>
                        <option value="Starr_Toon">Starr Toon</option>-->
                        <option value="Ice_Island">Ice Island</option>
                        <option value="Swamp_of_Love">Swamp of Love</option>
                        <option value="Medieval_Manor">MadEvil Manor</option>
                        <option value="Super_City_2">Kaiju Park</option> 
                        <!-- <option value="Spongebob">Bikini Bottom</option> -->
                        <option value="Oddities_Shop">Oddities Shop</option>
                        <!-- <option value="Skating_Bowl">Skating Bowl</option>
                        <option value="Hockey">Ice Rink</option>
                        <option value="Escape_Room">Pyramid Quest</option>
                        <option value="Katana Kingdom">Katana Kingdom</option> -->
                        <option value="Tropical_Island">Tropical Island</option>
                        <!-- <option value="Subway Surfers">Subway Surfers</option> -->
                    </select>
                </div>
            </div>
            <div class="tool-section">
                <h3>Tiles</h3>
                <div id="tileSelector"></div>
                <div class="save-export-buttons">
                    <button id="saveBtn" class="text-btn" title="Save Map (Ctrl+S)">
                        Save Map
                    </button>
                    <button id="exportBtn" class="text-btn" title="Export as PNG (Ctrl+E)">
                        Download Map
                    </button>
                    <button id="clearBtn" class="text-btn" title="Clear Map (Ctrl+Del)">
                        Clear Map
                    </button>
                </div>
            </div>
            <div style="font-family: Arial, Helvetica, sans-serif; font-weight: 900;">
                Link: <br/> <a id="mapLink" style="display:inline-block; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; max-width:100%; font-family: Arial, Helvetica, sans-serif; font-weight: 400; color: var(--primary-color);">https://she-fairy.github.io/atlas-horizon/map.html</a> 
            </div>
        </div>
        
        <div class="map-area">
            <div class="map-toolbar">
                <div class="checkbox-container">
                    <label>
                        <input type="checkbox" id="mirrorDiagonal">
                        Diagonal
                    </label>
                    <label>
                        <input type="checkbox" id="mirrorVertical">
                        Vertical
                    </label>
                    <label>
                        <input type="checkbox" id="mirrorHorizontal">
                        Horizontal
                    </label>
                </div>
                <div class="tool-buttons">
                    <label for="blue2RedBtn" title="Blue2Red (N)">
                        <input type="checkbox" id="blue2RedBtn">
                        <img src="./Resources/Additional/Icons/BlueToRed.png" alt="Blue2Red">
                    </label>
                </div>
                <div class="radio-container">
                    <label class="icon-btn" title="Single (1)">
                        <input type="radio" name="selectionMode" value="single" checked>
                        <img src="./Resources/Additional/Icons/Single.png" alt="Single">
                    </label>
                    <label class="icon-btn" title="Line (2)">
                        <input type="radio" name="selectionMode" value="line">
                        <img src="./Resources/Additional/Icons/Line.png" alt="Line">
                    </label>
                    <label class="icon-btn" title="Rectangle (3)">
                        <input type="radio" name="selectionMode" value="rectangle">
                        <img src="./Resources/Additional/Icons/Rectangle.png" alt="Rectangle">
                    </label>
                    <label class="icon-btn" title="Fill (4)">
                        <input type="radio" name="selectionMode" value="fill">
                        <img src="./Resources/Additional/Icons/Bucket.png" alt="Fill">
                    </label>
                    <label class="icon-btn" title="Select (5)">
                        <input type="radio" name="selectionMode" value="select">
                        <img src="./Resources/Additional/Icons/Select.png" alt="Select">
                    </label>
                </div>
                <div class="tool-buttons">
                    <label class="icon-btn" title="Erase (E)">
                        <input type="checkbox" id="eraseBtn">
                        <img src="./Resources/Additional/Icons/Erase.png" alt="Erase">
                    </label>
                    <button id="undoBtn" class="icon-btn" title="Undo (Ctrl+Z)">
                        <img src="./Resources/Additional/Icons/Undo.png" alt="Undo">
                    </button>
                    <button id="redoBtn" class="icon-btn" title="Redo (Ctrl+Y)">
                        <img src="./Resources/Additional/Icons/Redo.png" alt="Redo">
                    </button>
                    <label class="icon-btn" title="Replace (R)">
                        <input type="checkbox" id="replaceBtn">
                        <img src="./Resources/Additional/Icons/Replace.png" alt="Replace">
                    </label>
                    <label class="icon-btn" title="Errors (Q)">
                        <input type="checkbox" id="errorsBtn">
                        <img src="./Resources/Additional/Icons/Issues.png" alt="Errors">
                    </label>
                    <label class="icon-btn" title="Guides (W)">
                        <input type="checkbox" id="guidesBtn">
                        <img src="./Resources/Additional/Icons/Grid.png" alt="Guides">
                    </label>
                    <button id="zoomInBtn" class="icon-btn" title="Zoom In (Ctrl++)">
                        <img src="./Resources/Additional/Icons/GlassPlus.png" alt="Zoom In">
                    </button>
                    <button id="zoomOutBtn" class="icon-btn" title="Zoom Out (Ctrl+-)">
                        <img src="./Resources/Additional/Icons/GlassMinus.png" alt="Zoom Out">
                    </button>
                </div>
            </div>
            <div class="map-editor">
                <div class="map-container">
                    <canvas draggable="false" id="mapCanvas"></canvas>
                </div>
            </div>
        </div>
    </div>
    <div class="tooltip-floating disclaimer-tooltip">
        ?
        <div class="tooltip-text">
            This site is not affiliated with or endorsed by Supercell. Brawl Stars and all related assets belong to Supercell.
        </div>
    </div>
    <div class="tooltip-floating shortcuts-tooltip">
        <img src="./Resources/Additional/Icons/Key.png" alt="Keyboard Shortcuts">
        <div class="tooltip-text shortcuts-text">
            <h4>Keyboard Shortcuts</h4>
            <ul>
                <li><kbd>Ctrl/Shift</kbd> + <kbd>1</kbd> Diagonal</li>
                <li><kbd>Ctrl/Shift</kbd> + <kbd>2</kbd> Vertical</li>
                <li><kbd>Ctrl/Shift</kbd> + <kbd>3</kbd> Horizontal</li>
                <li><kbd>1</kbd> Single Selection</li>
                <li><kbd>2</kbd> Line Selection</li>
                <li><kbd>3</kbd> Rectangle Selection</li>
                <li><kbd>4</kbd> Fill Selection</li>
                <li><kbd>R</kbd> Toggle Replace Mode</li>
                <li><kbd>E</kbd> Toggle Erase Mode</li>
                <li><kbd>M</kbd> Toggle Mirroring</li>
                <li><kbd>N</kbd> Toggle Blue to Red Mirroring</li>
                <li><kbd>Q</kbd> Toggle Error Check</li>
                <li><kbd>Ctrl</kbd> + <kbd>Z</kbd> Undo</li>
                <li><kbd>Ctrl</kbd> + <kbd>Y</kbd> Redo</li>
                <li><kbd>Ctrl</kbd> + <kbd>Del</kbd> Clear Map</li>
            </ul>
        </div>
    </div>

    <script>
        const avatar = document.getElementById('avatar');
        avatar.src = localStorage.getItem('avatar');
        avatar.addEventListener('click', () => {
            if (confirm('Do you want to log out of this account?')){
                localStorage.clear();
                window.location.href = './index.html';
            }
        })
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script src="./js/firebase-service.js"></script>
    <script type="module" src="./js/mapmaker.js"></script>
</body>
</html>
